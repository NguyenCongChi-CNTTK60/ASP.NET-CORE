--- USE master
--- DROP DATABASE QUANLYNHANVIEN

CREATE DATABASE QUANLYNHANVIEN
GO

USE QUANLYNHANVIEN
GO

--- NHÂN VIÊN ---
CREATE TABLE NHANVIEN(
	MANV VARCHAR(10),
	HO NVARCHAR(20) NOT NULL,
	TENLOT NVARCHAR(20) NOT NULL,
	TEN NVARCHAR(20) NOT NULL,
	NGAYSINH DATE NOT NULL,
	GIOITINH NVARCHAR(3) CHECK (GIOITINH IN(N'Nam', N'Nữ')),
	DIACHI NVARCHAR(100),
	SDT VARCHAR(11),
	MAIL VARCHAR(50),
	MAQL VARCHAR(10),
	MAPB VARCHAR(10),
	MACV VARCHAR(10),
	MATD VARCHAR(10),

	PRIMARY KEY (MANV)
)


--- TABLE NHANVIEN ---
INSERT INTO NHANVIEN
	(MANV, HO, TENLOT, TEN, GIOITINH, NGAYSINH, DIACHI, SDT, MAIL, MAPB, MAQL, MACV, MATD)
VALUES
	--- PB GD ---
	('NV1', N'Nguyễn', N'Hữu', N'An', N'Nữ', CAST(N'2001-05-01' AS Date), N'Quận 9, TP.HCM','0328644258','nguyenhuuan@gmail.com','GD',NULL,'GD','DH'),
	('NV2', N'Lê', N'Nhật', N'Anh', N'Nam', CAST(N'2001-09-10' AS Date), N'Thủ Đức, TP.HCM','0328644259','lenhatanh@gmail.com','GD','NV1','PGD','DH'),
	('NV3', N'Nguyễn', N'Ngọc Tuấn', N'Anh', N'Nam', CAST(N'2001-02-08' AS Date), N'Bình Thạnh, TP.HCM','0328644269','nguyenngoctuananh@gmail.com','GD','NV1','CEO','DH'),
	('NV4', N'Phan', N'Nguyễn Trung', N'Anh', N'Nam', CAST(N'2000-05-02' AS Date), N'Quận 9, TP.HCM','0328644279','phannguyentrunganh@gmail.com','GD','NV1','TLGD','DH'),
	--- PB KT ---
	('NV5', N'Nguyễn', N'Công', N'Chí', N'Nam', CAST(N'2000-09-01' AS Date), N'Quận 9, TP.HCM','0328644999','nguyencongchi@gmail.com','KT',NULL,'NV','DH'),
	('NV6', N'Đỗ', N'Thành', N'Chiến', N'Nam', CAST(N'2000-11-20' AS Date), N'Quận 9, TP.HCM','0328644289','dothanhchien@gmail.com','KT','NV5','NV','DH'),
	--- PB M ---
	('NV7', N'Đặng', N'Ngọc', N'Chung', N'Nam', CAST(N'1999-08-10' AS Date), N'Quận 9, TP.HCM','0328644299','dangngocchung@gmail.com','M',NULL,'NV','TC'),
	('NV8', N'Huỳnh', N'Xuân', N'Lãm', N'Nam', CAST(N'2000-07-31' AS Date), N'Quận 9, TP.HCM','0328644250','huynhxuanlam@gmail.com','M','NV7','NV','CD'),
	--- TT
	('NV9', N'Nguyễn', N'Văn', N'Tiến', N'Nam', CAST(N'2000-04-13' AS Date), N'Thủ Đức, TP.HCM','0328694259','nguyenvantien@gmail.com','TT',NULL,'NV','DH'),
	('NV10', N'Dương', N'Thị Thanh', N'Thảo ', N'Nữ', CAST(N'2001-10-28' AS Date), N'Quận 9, TP.HCM','0329644259','duongthithanhthao@gmail.com','TT','NV9','NV','DH'),
	--- KD
	('NV11', N'Nguyễn', N'Văn', N'Du', N'Nam', CAST(N'2001-05-03' AS Date), N'Thủ Đức, TP.HCM','0328646259','nguyenvandu@gmail.com','KD',NULL,'NV','DH'),
	('NV12', N'Lê', N'Thanh', N'Duẫn', N'Nam', CAST(N'1998-11-08' AS Date), N'Thủ Đức, TP.HCM','0328884259','lethanhduan@gmail.com','KD','NV11','NV','DH'),
	--- NS
	('NV13', N'Nguyễn', N'Tiến', N'Đạt', N'Nam', CAST(N'1996-09-25' AS Date), N'Thủ Đức, TP.HCM','0328644276','nguyentiendat@gmail.com','NS',NULL,'NV','CD'),
	('NV14', N'Phan', N'Thị', N'Đông', N'Nữ', CAST(N'1996-05-02' AS Date), N'Quận 9, TP.HCM','0328644290','phanthidong@gmail.com','NS','NV13','NV','DH'),
	--- IT
	('NV15', N'Trần', N'Viết', N'Học', N'Nam', CAST(N'1997-02-13' AS Date), N'Quận 9, TP.HCM','0328644266','tranviethoc@gmail.com','IT',NULL,'NV','DH');


--- PHÒNG BAN ---
CREATE TABLE PHONGBAN(
	MAPB VARCHAR(10),
	TENPHONGBAN NVARCHAR(50) UNIQUE,
	TRUONGPHONG VARCHAR(10),
	DIACHI NVARCHAR(100),

	PRIMARY KEY (MAPB)
)


--- TABLE PHONGBAN ---
INSERT INTO PHONGBAN
	(MAPB, TENPHONGBAN, DIACHI, TRUONGPHONG)
VALUES
	('GD', N'Giám đốc', N'10D3', 'NV1'),
	('KT', N'Kế toán', N'101C2', 'NV5'),
	('M' , N'Marketing', N'103C2', 'NV7'),
	('TT', N'Tiếp thị', N'201C2', 'NV9'),
	('KD', N'Kinh doanh', N'202C2', 'NV11'),
	('NS', N'Nhân sự', N'203C2', 'NV13'),
	('IT', N'Công nghệ thông tin', N'204E7', 'NV15');


--- CHỨC VỤ ---
CREATE TABLE CHUCVU(
	MACV VARCHAR(10),
	TENCHUCVU NVARCHAR(50) UNIQUE,

	PRIMARY KEY (MACV)
)


--- TABLE CHUCVU ---
INSERT INTO CHUCVU
	(MACV, TENCHUCVU)
VALUES
	('GD', N'Giám đốc'),
	('PGD', N'Phó giám đốc'),
	('CEO', N'Giám đốc điều hành'),
	('TLGD', N'Trợ lý giám đốc'),
	('NV', N'Nhân viên');


--- TRÌNH ĐỘ ---
CREATE TABLE TRINHDO(
	MATD VARCHAR(10),
	TENTRINHDO NVARCHAR(50) UNIQUE,

	PRIMARY KEY (MATD)
)


--- TABLE TRINHDO ---
INSERT INTO TRINHDO
	(MATD, TENTRINHDO)
VALUES
	('DH', N'Đại học'),
	('CD', N'Cao đẳng'),
	('TC', N'Trung cấp');



--- ĐỀ ÁN ---
CREATE TABLE DEAN(
	MADA VARCHAR(10),
	TENDEAN NVARCHAR(100) NOT NULL,
	MAPB VARCHAR(10),

	PRIMARY KEY (MADA)
)

--- TABLE DEAN ---
INSERT INTO DEAN
	(MADA, TENDEAN, MAPB)
VALUES
	('DA1', N'Kí hợp đồng với công ty', 'GD'),
	('DA2', N'Phát triển công ty tăng 10% giá trị', 'GD'),
	('DA3', N'Kiểm tra hoạt động phát triển của công ty', 'GD'),
	('DA4', N'Kiểm kê tài chính', 'KT'),
	('DA5', N'Quảng bá sản phẩm tăng 20% số lượng người dùng', 'M'),
	('DA6', N'Đón nhà đầu tư tham quan công ti', 'TT'),
	('DA7', N'Bán gấp toàn bộ sản phẩm tồn dư', 'KD'),
	('DA8', N'Tuyển thêm 1 bảo mật viên', 'NS'),
	('DA9', N'Tuyển thêm 3 nhân viên Maketing', 'NS'),
	('DA10', N'Kiểm tra cơ sở dữ liệu công ty', 'IT');



--- NHÂN VIÊN VÀ ĐỀ ÁN ---
CREATE TABLE NHANVIEN_DEAN(
	MADA VARCHAR(10),
	MANV VARCHAR(10),
	THOIGIAN INT CHECK(THOIGIAN > 0),

	PRIMARY KEY(MADA, MANV)
)



--- TABLE NHANVIEN_DEAN ---
INSERT INTO NHANVIEN_DEAN
	(MADA, MANV, THOIGIAN)
VALUES
	('DA1', 'NV1', 7),
	('DA1', 'NV4', 7),
	('DA2', 'NV2', 3),
	('DA3', 'NV3', 3),
	('DA4', 'NV4', 5),
	('DA4', 'NV5', 5),
	('DA4', 'NV6', 5),
	('DA5', 'NV7', 7),
	('DA5', 'NV8', 7),
	('DA6', 'NV9', 5),
	('DA6', 'NV10', 5),
	('DA7', 'NV11', 14),
	('DA7', 'NV12', 14),
	('DA8', 'NV13', 7),
	('DA9', 'NV13', 7),
	('DA9', 'NV14', 7),
	('DA10', 'NV15', 3);



--- BẢO HIỂM ---
CREATE TABLE BAOHIEM(
	MABH VARCHAR(10),
	TENBAOHIEM NVARCHAR(50) UNIQUE,
	CHIPHI MONEY NOT NULL CHECK(CHIPHI > 0),

	PRIMARY KEY (MABH)
)

--- TABLE BAOHIEM ---
INSERT INTO BAOHIEM
	(MABH, TENBAOHIEM, CHIPHI)
VALUES
	('BHYT', N'Bảo hiểm y tế', 300000),
	('BHTNLDBNN', N'Bảo hiểm tai nạn lao động, bệnh nghề nghiệp', 400000),
	('BHXH', N'Bảo hiểm xã hội', 500000),
	('BHTN', N'Bảo hiểm thất nghiệp', 600000);



--- NHÂN VIÊN VÀ BẢO HIỂM ---
CREATE TABLE NHANVIEN_BAOHIEM(
	MABH VARCHAR(10),
	MANV VARCHAR(10),

	PRIMARY KEY(MABH, MANV)
)


--- TABLE NHANVIEN_BAOHIEM ---
INSERT INTO NHANVIEN_BAOHIEM
	(MANV, MABH)
VALUES
	('NV1','BHYT'),	('NV2','BHYT'),	('NV3','BHYT'),	('NV4','BHYT'),	('NV5','BHYT'),
	('NV6','BHYT'),	('NV7','BHYT'),	('NV8','BHYT'),	('NV9','BHYT'),	('NV10','BHYT'),
	('NV11','BHYT'), ('NV12','BHYT'), ('NV13','BHYT'), ('NV14','BHYT'), ('NV15','BHYT'),
	('NV1','BHTNLDBNN'), ('NV2','BHTNLDBNN'), ('NV3','BHTNLDBNN'), ('NV4','BHTNLDBNN'),
	('NV5','BHTNLDBNN'), ('NV6','BHTNLDBNN'), ('NV7','BHTNLDBNN'), ('NV8','BHTNLDBNN'),
	('NV1','BHXH'),	('NV2','BHXH'),	('NV3','BHXH'),	('NV4','BHXH'),	('NV5','BHXH'),
	('NV6','BHXH'),	('NV7','BHXH'),	('NV8','BHXH'),	('NV9','BHXH'),	('NV10','BHXH'),
	('NV11','BHXH'), ('NV12','BHXH'), ('NV13','BHXH'), ('NV14','BHXH'), ('NV15','BHXH'),
	('NV1','BHTN'),	('NV2','BHTN'),	('NV3','BHTN'),	('NV4','BHTN'),	('NV5','BHTN'),
	('NV6','BHTN'),	('NV7','BHTN'),	('NV8','BHTN'),	('NV9','BHTN'),	('NV10','BHTN'),
	('NV11','BHTN'), ('NV12','BHTN'), ('NV13','BHTN'), ('NV14','BHTN'), ('NV15','BHTN');



--- LƯƠNG ---
CREATE TABLE LUONG(
	BACLUONG INT,
	LUONGPHUCAP MONEY CHECK(LUONGPHUCAP > 0),

	PRIMARY KEY (BACLUONG)
)



--- TABLE LUONG ---
INSERT INTO LUONG
	(BACLUONG, LUONGPHUCAP)
VALUES
	(1,500000),
	(2,1000000),
	(3,1500000),
	(4,2000000),
	(5,2500000);


--- NHÂN VIÊN VÀ LƯƠNG ---
CREATE TABLE NHANVIEN_LUONG(
	MANV VARCHAR(10),
	BACLUONG INT,
	LUONGCOBAN MONEY CHECK(LUONGCOBAN >= 0),

	PRIMARY KEY (MANV, BACLUONG)
)


INSERT INTO NHANVIEN_LUONG
	(MANV, BACLUONG, LUONGCOBAN)
VALUES
	('NV1',5,40000000),
	('NV2',5,35000000),
	('NV3',5,45000000),
	('NV4',4,30000000),
	('NV5',3,20000000),
	('NV6',2,15000000),
	('NV7',2,20000000),
	('NV8',2,10000000),
	('NV9',3,20000000),
	('NV10',2,20000000),
	('NV11',3,20000000),
	('NV12',1,8000000),
	('NV13',3,20000000),
	('NV14',1,8000000),
	('NV15',3,30000000);
	



--- HỢP ĐỒNG ---
CREATE TABLE HOPDONG(
	MAHD VARCHAR(10),
	LOAIHOPDONG NVARCHAR(30) UNIQUE,

	PRIMARY KEY (MAHD)
)


--- TABLE HOPDONG ---
INSERT INTO HOPDONG
	(MAHD, LOAIHOPDONG)
VALUES
	('TV', N'Hợp đồng thử việc'),
	('TM', N'Hợp đồng theo theo mùa'),
	('KTH', N'Hợp đồng không thời hạn'),
	('TH', N'Hợp đồng có thời hạn');



--- NHÂN VIÊN VÀ HỢP ĐỒNG ---
CREATE TABLE NHANVIEN_HOPDONG(
	MANV VARCHAR(10),
	MAHD VARCHAR(10),
	NGAYBATDAU DATE NOT NULL,
	NGAYKETTHUC DATE,

	PRIMARY KEY (MANV, MAHD)
)



--- TABLE NHANVIEN_HOPDONG ---
INSERT INTO NHANVIEN_HOPDONG
	(MANV, MAHD, NGAYBATDAU, NGAYKETTHUC)
VALUES
	('NV1','KTH',CAST(N'2020-07-01' AS Date), NULL),
	('NV2','TH',CAST(N'2020-07-01' AS Date),CAST(N'2023-07-01' AS Date)),
	('NV3','TH',CAST(N'2020-07-01' AS Date),CAST(N'2023-07-01' AS Date)),
	('NV4','TH',CAST(N'2020-07-01' AS Date),CAST(N'2023-07-01' AS Date)),
	('NV5','TH',CAST(N'2020-07-01' AS Date),CAST(N'2022-07-01' AS Date)),
	('NV6','TH',CAST(N'2020-07-01' AS Date),CAST(N'2022-07-01' AS Date)),
	('NV7','TH',CAST(N'2020-07-01' AS Date),CAST(N'2022-07-01' AS Date)),
	('NV8','TM',CAST(N'2020-07-01' AS Date),CAST(N'2021-07-01' AS Date)),
	('NV9','TH',CAST(N'2020-07-01' AS Date),CAST(N'2022-07-01' AS Date)),
	('NV10','TM',CAST(N'2020-07-01' AS Date),CAST(N'2021-07-01' AS Date)),
	('NV11','TH',CAST(N'2020-07-01' AS Date),CAST(N'2022-07-01' AS Date)),
	('NV12','TV',CAST(N'2020-07-01' AS Date),CAST(N'2020-08-01' AS Date)),
	('NV13','TH',CAST(N'2020-07-01' AS Date),CAST(N'2023-07-01' AS Date)),
	('NV14','TV',CAST(N'2020-07-01' AS Date),CAST(N'2020-08-01' AS Date)),
	('NV15','TH',CAST(N'2020-07-01' AS Date),CAST(N'2023-07-01' AS Date));




--- CHẤM CÔNG ---
CREATE TABLE CHAMCONG(
	MANV VARCHAR(10),
	NGAY DATE,
	TRANGTHAI BIT NOT NULL,
	SOGIOTANGCA INT CHECK(SOGIOTANGCA >=0 AND SOGIOTANGCA <=4),
	TIENTHUONG MONEY CHECK(TIENTHUONG >= 0),
	TIENPHAT  MONEY CHECK(TIENPHAT >= 0),

	PRIMARY KEY(MANV, NGAY)
)


--- TABLE CHAMCONG ---
INSERT INTO CHAMCONG
	(NGAY, MANV, TRANGTHAI, SOGIOTANGCA, TIENTHUONG, TIENPHAT)
VALUES
	--- 2020-07-01 ---
	(CAST(N'2020-07-01' AS Date),'NV1',1, 2, 0, 0),(CAST(N'2020-07-01' AS Date),'NV2',1, 0, 0, 0),(CAST(N'2020-07-01' AS Date),'NV3',1, 0, 0, 100000),
	(CAST(N'2020-07-01' AS Date),'NV4',1, 3, 0, 0),(CAST(N'2020-07-01' AS Date),'NV5',1, 0, 0, 0),(CAST(N'2020-07-01' AS Date),'NV6',1, 0, 0, 0),
	(CAST(N'2020-07-01' AS Date),'NV7',1, 0, 0, 0),(CAST(N'2020-07-01' AS Date),'NV8',0, 0, 0, 0),(CAST(N'2020-07-01' AS Date),'NV9',1, 0, 0, 0),
	(CAST(N'2020-07-01' AS Date),'NV10',1, 4, 0, 0),(CAST(N'2020-07-01' AS Date),'NV11',1, 0, 0, 0),(CAST(N'2020-07-01' AS Date),'NV12',1, 0, 0, 0),
	(CAST(N'2020-07-01' AS Date),'NV13',0, 0, 0, 0),(CAST(N'2020-07-01' AS Date),'NV14',1, 0, 0, 0),(CAST(N'2020-07-01' AS Date),'NV15',1, 0, 0, 0),
	--- 2020-07-02 ---
	(CAST(N'2020-07-02' AS Date),'NV1',1, 0, 0, 0),(CAST(N'2020-07-02' AS Date),'NV2',0, 0, 0, 0),(CAST(N'2020-07-02' AS Date),'NV3',1, 0, 0, 0),
	(CAST(N'2020-07-02' AS Date),'NV4',0, 0, 0, 0),(CAST(N'2020-07-02' AS Date),'NV5',1, 0, 100000, 0),(CAST(N'2020-07-02' AS Date),'NV6',1, 0, 0, 0),
	(CAST(N'2020-07-02' AS Date),'NV7',1, 2, 0, 0),(CAST(N'2020-07-02' AS Date),'NV8',1, 4, 0, 0),(CAST(N'2020-07-02' AS Date),'NV9',1, 0, 0, 0),
	(CAST(N'2020-07-02' AS Date),'NV10',0, 0, 0, 0),(CAST(N'2020-07-02' AS Date),'NV11',1, 0, 0, 0),(CAST(N'2020-07-02' AS Date),'NV12',1, 0, 0, 0),
	(CAST(N'2020-07-02' AS Date),'NV13',1, 0, 0, 0),(CAST(N'2020-07-02' AS Date),'NV14',1, 0, 0, 0),(CAST(N'2020-07-02' AS Date),'NV15',0, 0, 0, 0),
	--- 2020-07-03 ---
	(CAST(N'2020-07-03' AS Date),'NV1',1, 4, 0, 100000),(CAST(N'2020-07-03' AS Date),'NV2',1, 0, 0, 0),(CAST(N'2020-07-03' AS Date),'NV3',1, 0, 0, 100000),
	(CAST(N'2020-07-03' AS Date),'NV4',1, 2, 0, 0),(CAST(N'2020-07-03' AS Date),'NV5',1, 0, 0, 0),(CAST(N'2020-07-03' AS Date),'NV6',1, 0, 0, 0),
	(CAST(N'2020-07-03' AS Date),'NV7',1, 0, 0, 0),(CAST(N'2020-07-03' AS Date),'NV8',1, 0, 0, 0),(CAST(N'2020-07-03' AS Date),'NV9',1, 0, 0, 0),
	(CAST(N'2020-07-03' AS Date),'NV10',1, 2, 0, 0),(CAST(N'2020-07-03' AS Date),'NV11',1, 0, 0, 0),(CAST(N'2020-07-03' AS Date),'NV12',1, 0, 0, 0),
	(CAST(N'2020-07-03' AS Date),'NV13',1, 2, 0, 0),(CAST(N'2020-07-03' AS Date),'NV14',1, 0, 0, 100000),(CAST(N'2020-07-03' AS Date),'NV15',0, 0, 0, 0);



--- KHOA NGOAI -----
--- TABLE NHANVIEN ---
ALTER TABLE NHANVIEN ADD FOREIGN KEY(MAQL) REFERENCES NHANVIEN(MANV)
ALTER TABLE NHANVIEN ADD FOREIGN KEY(MAPB) REFERENCES PHONGBAN(MAPB)
ALTER TABLE NHANVIEN ADD FOREIGN KEY(MACV) REFERENCES CHUCVU(MACV)
ALTER TABLE NHANVIEN ADD FOREIGN KEY(MATD) REFERENCES TRINHDO(MATD)

--- TABLE PHONGBAN ---
ALTER TABLE PHONGBAN ADD FOREIGN KEY(TRUONGPHONG) REFERENCES NHANVIEN(MANV)

--- TABLE NHANVIEN_DEAN ---
ALTER TABLE NHANVIEN_DEAN ADD FOREIGN KEY(MANV) REFERENCES NHANVIEN(MANV)
ALTER TABLE NHANVIEN_DEAN ADD FOREIGN KEY(MADA) REFERENCES DEAN(MADA)

--- TABLE NHANVIEN_BAOHIEM ---
ALTER TABLE NHANVIEN_BAOHIEM ADD FOREIGN KEY(MANV) REFERENCES NHANVIEN(MANV)
ALTER TABLE NHANVIEN_BAOHIEM ADD FOREIGN KEY(MABH) REFERENCES BAOHIEM(MABH)

--- TABLE NHANVIEN_LUONG ---
ALTER TABLE NHANVIEN_LUONG ADD FOREIGN KEY(MANV) REFERENCES NHANVIEN(MANV)
ALTER TABLE NHANVIEN_LUONG ADD FOREIGN KEY(BACLUONG) REFERENCES LUONG(BACLUONG)

--- TABLE NHANVIEN_HOPDONG ---
ALTER TABLE NHANVIEN_HOPDONG ADD FOREIGN KEY(MANV) REFERENCES NHANVIEN(MANV)
ALTER TABLE NHANVIEN_HOPDONG ADD FOREIGN KEY(MAHD) REFERENCES HOPDONG(MAHD)

--- TABLE CHAMCONG ---
ALTER TABLE CHAMCONG ADD FOREIGN KEY(MANV) REFERENCES NHANVIEN(MANV)

--- 1 SỐ CÂU LỆNH SQL ---

--- TÍNH LƯƠNG CHO NHÂN VIÊN ---
SELECT CHAMCONG.MANV, (LUONGCOBAN+LUONGPHUCAP)/26*COUNT(*) 
	   + SUM(TIENTHUONG) - SUM(TIENPHAT) 
	   + (LUONGCOBAN+LUONGPHUCAP)/26/8*0.15*SUM(SOGIOTANGCA) AS 'LUONG NHAN DUOC'
FROM ((CHAMCONG 
	INNER JOIN NHANVIEN_LUONG ON NHANVIEN_LUONG.MANV = CHAMCONG.MANV)
	INNER JOIN LUONG ON NHANVIEN_LUONG.BACLUONG = LUONG.BACLUONG)
WHERE MONTH(CHAMCONG.NGAY) = 7 AND YEAR(CHAMCONG.NGAY) = 2020 AND CHAMCONG.TRANGTHAI = 1
GROUP BY CHAMCONG.MANV, LUONGCOBAN, LUONGPHUCAP

--- SỐ LƯỢNG ĐỀ ÁN NHÂN VIÊN ĐANG LÀM ---
SELECT MANV, COUNT(*) AS 'SO LUONG'
FROM NHANVIEN_DEAN
GROUP BY MANV

--- THÁNG 7 TRƯỞNG PHÒNG IT NGHỈ BAO NHIÊU LẦN ---
SELECT COUNT(*) AS 'SO LAN'
FROM PHONGBAN INNER JOIN CHAMCONG ON TRUONGPHONG = MANV
WHERE MAPB = 'IT' AND MONTH(CHAMCONG.NGAY) = 7 AND YEAR(CHAMCONG.NGAY) = 2020 AND CHAMCONG.TRANGTHAI = 0
GROUP BY TRUONGPHONG

--- CÁC LOẠI BẢO HIỂM MÀ GIÁM ĐỐC ĐANG THAM GIA 
SELECT BAOHIEM.TENBAOHIEM
FROM ((BAOHIEM 
	INNER JOIN NHANVIEN_BAOHIEM ON BAOHIEM.MABH = NHANVIEN_BAOHIEM.MABH)
	INNER JOIN NHANVIEN ON NHANVIEN.MANV = NHANVIEN_BAOHIEM.MANV)
WHERE NHANVIEN.MACV = 'GD'

--- SỐ LƯỢNG NHÂN VIÊN LÀM VIỆC TẠI CÁC PHÒNG BAN
SELECT TENPHONGBAN, COUNT(*) AS 'SOLUONG'
FROM NHANVIEN INNER JOIN PHONGBAN ON NHANVIEN.MAPB = PHONGBAN.MAPB
GROUP BY NHANVIEN.MAPB, TENPHONGBAN


--- SỐ LƯỢNG NHÂN VIÊN NAM,NỮ CỦA CÔNG TY ----
SELECT GIOITINH,COUNT(*) AS SOLUONG 
FROM NHANVIEN 
GROUP BY GIOITINH 


--- NHÂN VIÊN CÔNG TY LƠN HON 23 TUỔI ----
SELECT *
FROM NHANVIEN 
WHERE ((YEAR(GETDATE()))  -  (YEAR(NGAYSINH))) >= 23



